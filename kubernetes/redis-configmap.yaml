apiVersion: v1
kind: ConfigMap
metadata:
  name: redis-cluster-configmap
  namespace: demo
  labels:
    app: redis
data:
  master.conf: |
    maxmemory 400mb
    maxmemory-policy allkeys-lru
    maxclients 20000
    timeout 300
    dbfilename dump.rdb
    appendonly yes
    protected-mode no
    dir /var/lib/redis
  slave.conf: |
    slaveof redis-ss-0.redis-ss.redis 6379
    maxmemory 400mb
    maxmemory-policy allkeys-lru
    maxclients 20000
    timeout 300
    appendonly yes
    protected-mode no
    dir /var/lib/redis

# apiVersion: v1
# kind: ConfigMap
# metadata:
#   name: redis-server
#   namespace: demo
# data:
#   update-node.sh: |
#     #!/bin/sh
#     REDIS_NODES="/data/nodes.conf"
#     sed -i -e "/myself/ s/[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}/${POD_IP}/" ${REDIS_NODES}
#     exec "$@"
#   redis.conf: |+
#     cluster-enabled yes
#     cluster-require-full-coverage no
#     cluster-node-timeout 15000
#     cluster-config-file /data/nodes.conf
#     cluster-migration-barrier 1
#     appendonly yes
#     protected-mode no
#     dir /var/lib/redis

# apiVersion: v1
# kind: ConfigMap
# metadata:
#   name: redis-ss-configuration
#   namespace: demo
#   labels:
#     app: redis
# data:
#   master.conf: |
#     maxmemory 400mb
#     maxmemory-policy allkeys-lru
#     maxclients 20000
#     timeout 300
#     appendonly yes
#     protected-mode no
#     dbfilename dump.rdb
#     dir /var/lib/redis
#   slave.conf: |
#     slaveof redis-ss-0.redis-ss.redis 6379
#     maxmemory 400mb
#     maxmemory-policy allkeys-lru
#     maxclients 20000
#     timeout 300
#     dir /var/lib/redis

